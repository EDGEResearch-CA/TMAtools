<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>TMAtools pipeline — tmatools • TMAtools</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TMAtools pipeline — tmatools"><meta name="description" content="This function runs the TMAtools pipeline for multiple TMA directories.
It combines TMA datasets, deconvolutes the combined dataset,
and translates numerical biomarker scores to nominal scores."><meta property="og:description" content="This function runs the TMAtools pipeline for multiple TMA directories.
It combines TMA datasets, deconvolutes the combined dataset,
and translates numerical biomarker scores to nominal scores."><meta property="og:image" content="https://edgeresearch-ca.github.io/tmatools/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TMAtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.edgeresearch.ca" target="_blank"><span class="fa fa-microscope"></span> EDGE Research Lab</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EDGEResearch-CA/TMAtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>TMAtools pipeline</h1>
      <small class="dont-index">Source: <a href="https://github.com/EDGEResearch-CA/TMAtools/blob/master/R/tmatools.R" class="external-link"><code>R/tmatools.R</code></a></small>
      <div class="d-none name"><code>tmatools.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function runs the TMAtools pipeline for multiple TMA directories.
It combines TMA datasets, deconvolutes the combined dataset,
and translates numerical biomarker scores to nominal scores.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tmatools</span><span class="op">(</span></span>
<span>  <span class="va">tma_dirs</span>,</span>
<span>  <span class="va">biomarker_rules_file</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"tmatools_output"</span>,</span>
<span>  combined_tma_file <span class="op">=</span> <span class="st">"1_combined_tma.xlsx"</span>,</span>
<span>  deconvoluted_tma_file <span class="op">=</span> <span class="st">"2_deconvoluted_tma.xlsx"</span>,</span>
<span>  translated_tma_file <span class="op">=</span> <span class="st">"3_translated_tma.xlsx"</span>,</span>
<span>  consolidated_tma_file <span class="op">=</span> <span class="st">"4_consolidated_tma.xlsx"</span>,</span>
<span>  final_tma_file <span class="op">=</span> <span class="st">"5_final_consolidated_tmas.xlsx"</span>,</span>
<span>  biomarker_sheet_index <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tma-dirs">tma_dirs<a class="anchor" aria-label="anchor" href="#arg-tma-dirs"></a></dt>
<dd><p>A character vector of TMA directory paths.
Each directory must contain:</p><ul><li><p><code>Score sheets</code>: one or more Excel files with biomarker scores (one biomarker per sheet).</p></li>
<li><p><code>Clean map</code>: an Excel file with "clean_map" in the file name.
This file corresponds to the sector map of your TMA that only contains
the core IDs within the corresponding cells. No other annotation outside
the map is allowed, as <code>TMAtools</code> uses the exact positions of core IDs
to map corresponding scores.
Optional:</p></li>
<li><p><code>Metadata</code>: An Excel file with "metadata" in the name.
In a single tab, it must contain at least two columns:
"core_id" (core IDs that appear in the sector map) and "accession_id"
(case or patient identifiers). Optionally, you can add other columns
with additional metadata (e.g., age, sex, histotype, block number),
which will be carried forward to your output files.</p></li>
</ul></dd>


<dt id="arg-biomarker-rules-file">biomarker_rules_file<a class="anchor" aria-label="anchor" href="#arg-biomarker-rules-file"></a></dt>
<dd><p>Path to spreadsheet containing the consolidation rules for all biomarkers.
It must contain a sheet named "consolidation" with columns
"biomarker", "rule_type", "rule_value", "consolidated_value".
It must not be located within any of the TMA directories being processed.</p></dd>


<dt id="arg-output-dir">output_dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>The directory where the output files will be saved.</p></dd>


<dt id="arg-combined-tma-file">combined_tma_file<a class="anchor" aria-label="anchor" href="#arg-combined-tma-file"></a></dt>
<dd><p>The name of the combined TMA file.</p></dd>


<dt id="arg-deconvoluted-tma-file">deconvoluted_tma_file<a class="anchor" aria-label="anchor" href="#arg-deconvoluted-tma-file"></a></dt>
<dd><p>The name of the deconvoluted TMA file.</p></dd>


<dt id="arg-translated-tma-file">translated_tma_file<a class="anchor" aria-label="anchor" href="#arg-translated-tma-file"></a></dt>
<dd><p>The name of the translated TMA file.</p></dd>


<dt id="arg-consolidated-tma-file">consolidated_tma_file<a class="anchor" aria-label="anchor" href="#arg-consolidated-tma-file"></a></dt>
<dd><p>The name of the consolidated TMA file.</p></dd>


<dt id="arg-final-tma-file">final_tma_file<a class="anchor" aria-label="anchor" href="#arg-final-tma-file"></a></dt>
<dd><p>The name of the final file containing the consolidated scores from multiple TMAs processed.</p></dd>


<dt id="arg-biomarker-sheet-index">biomarker_sheet_index<a class="anchor" aria-label="anchor" href="#arg-biomarker-sheet-index"></a></dt>
<dd><p>The index of the biomarker sheet in the TMA file.
All TMA files must have the biomarker data in the same sheet index. Defaults to 2 (ie, second sheet).</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://edgeresearch-ca.github.io/TMAtools" class="external-link">TMAtools</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tma_dirs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tma1"</span>, package <span class="op">=</span> <span class="st">"TMAtools"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tma2"</span>, package <span class="op">=</span> <span class="st">"TMAtools"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># spreadsheet with translation and consolidation rules</span></span></span>
<span class="r-in"><span><span class="va">biomarker_rules_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"extdata"</span>, <span class="st">"biomarker_rules_example.xlsx"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"TMAtools"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Run the TMAtools pipeline</span></span></span>
<span class="r-in"><span><span class="fu">tmatools</span><span class="op">(</span></span></span>
<span class="r-in"><span>  tma_dirs <span class="op">=</span> <span class="va">tma_dirs</span>,</span></span>
<span class="r-in"><span>  biomarker_rules_file <span class="op">=</span> <span class="va">biomarker_rules_file</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="st">"tmatools_output"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Processing TMA: tma1</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding placeholder column for biomarker PTEN</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Processing TMA: tma2</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 36 × 17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    accession_id tma_id core_id age   sex   ER.c1     ER.c2 ER.c3 PTEN.c0 PTEN.c1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> pt1.tma1     tma1   1       1     m     Unk       Unk   Unk   Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> pt4.tma1     tma1   4       2     f     diffuse … nega… nega… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> pt10.tma1    tma1   10      52    f     Unk       Unk   nega… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> pt13.tma1    tma1   13      51    f     Unk       foca… foca… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> pt3.tma1     tma1   3       2     f     diffuse … Unk   foca… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> pt12.tma1    tma1   12      54    f     Unk       Unk   Unk   Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> pt5.tma1     tma1   5       0     Unk   diffuse … diff… diff… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> pt14.tma1    tma1   14      54    f     focal (1… diff… foca… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> pt2.tma1     tma1   2       1     m     focal (1… diff… diff… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> pt11.tma1    tma1   11      45    f     diffuse … Unk   nega… Unk     <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 26 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 7 more variables: PTEN.c2 &lt;chr&gt;, er &lt;chr&gt;, p53 &lt;chr&gt;, p53.c1 &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   p53.c2 &lt;chr&gt;, p53.c3 &lt;chr&gt;, pten &lt;chr&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bianca Ribeiro de Souza, Endometriosis Oncogenomics and Pathology Research Lab.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

